# GraphQL là gì?
- GraphQL giống như cách bạn gọi món ở quán ăn. Thay vì quán mang tất cả mọi thứ trong menu, bạn có thể chỉ chọn những món mà bạn thích, KHÔNG THỪA
## Ví dụ thực tế
- Bạn đến 1 quán ăn. Quán có nhiều món như: Tôm hùm, cua hoàng đế, bào ngư, vi cá,... nhưng bạn chỉ muốn ăn tôm hùm & bào ngư
### Cách cũ (Không dùng GraphQL - giống RESTAPI)
- Bạn gọi: "Tiểu nhị, cho đồ ăn lên"
- Tiểu nhị sẽ mang hết Tôm hùm, cua hoàng đế, bào ngư, vi cá,... - Cả đống thứ bạn không cần. Bạn phải tự chọn lấy tôm hùm & bào ngư, nhưng món còn lại bỏ đi -> Tốn công & thời gian
### Dùng GraphQL
- Bạn nói rõ với tiểu nhị: "Cho tôm hùm & bào ngư lên thôi"
- Tiểu nhị sẽ mang đúng 2 món trên, KHÔNG THỪA cũng KHÔNG THIẾU
- **GraphQL cũng thế, nó cho phép bạn yêu cầu chính xác những bạn cần từ server, không lấy thừa thêm gì cả**
# Lý do nên sử dụng GraphQL
- `Tiết kiệm`: Không load các dữ liệu thừa
- `Dễ hiểu`: Nói rõ muốn gì, server làm đúng như vậy
- `Nhanh hơn`: Vì chỉ lấy đúng thứ ta muốn

# GraphQL hoạt động như thế nào?
- Hãy tưởng tượng GraphQL như 1 **quán ăn đặc biệt**, có 3 người cùng làm việc để phục vụ bạn:
  - `Bạn (Query)`: Người gọi món, nói rõ muốn ăn gì
  - `Thực đơn (Schema)`: Menu ghi tất cả các món mà quán có
  - `Đầu bếp (Resolver)`: Người đi lấy nguyên liệu & nấu món mà bạn gọi
- Luồng chạy sẽ như sau. Đầu tiên chúng ta sẽ đi đến quán
  - **Nhìn menu (Schema)**: "À quán có Tôm hùm, cua hoàng đế, bào ngư, vi cá,..."
  - **Gọi món (Query)**: "Tiểu nhị, cho tôm hùm & bào ngư nhé"
  - **Đầu bếp làm việc (Resolver)**: Đầu bếp chạy vào bếp, lấy tôm hùm, bào ngư, làm xong & mang ra cho bạn
- GraphQL cũng vậy - Ví dụ chúng ta làm việc với thông tin về nhân vật trong game
  - **Schema**: "Tôi có dữ liệu về tên, màu, trang phục, giá,... của nhân vật game"
  - **Query**: "Cho tôi tên & giá"
  - **Resolver**: Server tìm đúng dữ liệu & trả về "Tên: Van heo, giá: 1 jack"

# Cách viết query cụ thể
- Query là "Lời yêu cầu" bạn gửi đến server, giống như bạn gọi món ở quán. Trong GraphQL, bạn viết Query để nói rõ bạn muốn dữ liệu gì. Thực ra thì nó không khó, bạn chỉ cần liệt kê ra những gì bạn mong muốn thôi
- Như ở ví dụ trên, thực đơn của chúng ta có các món sau
  - Tôm hùm
  - Cua hoàng đế
  - Bào ngư
  - Vi cá
- Bạn muốn Tôm hùm & Vi cá. Thay vì nói lung tung, bạn viết "đơn đặt hàng" như thế này
```
Cho tôi:
  - Tôm hùm
  - Vi cá
```
- Trong GraphQL, bạn cũng viết như thế nhưng viết cho server hiểu
```js
query {
  haiSan {
    tomHum
    viCa
  }
}
```
  - `query`: Tôi muốn gọi gì đó
  - `haiSan`: Tên phần muốn lấy (giống như danh sách các loại trong thực đơn)
  - `tomHum`, `viCa`: Các thứ cụ thể mà bạn muốn

# Cách schema được tạo ra
- Giống như quyển thực đơn, nó được tạo ra để nói cho bạn biết server có những dữ liệu gì để bạn chọn
- Ví dụ, chủ quán ở trên ngồi xuống & viết menu
  - Hải sản: Tôm hùm, bào ngư
  - Thịt: Thịt luộc, thịt kho
- Trong GraphQL, chúng ta cũng viết Schema kiểu như vậy
```js
type HaiSan {
  tomHum: String,
  baoNgu: String
}

type Thit {
  thitLuoc: String,
  thitKho: String
}
```
- `type HaiSan, Thit`: Nghĩa là đây là danh mục hải sản và thịt
- `tomHum`: Đây là 1 món dạng string - Tương tự với các món khác

## Ai tạo ra Schema
- dev quyết định Schema sẽ trông như nào, giống như chủ tiệm quán bên trên
- Bạn (Người dùng), chỉ được chọn ở trong Schema đó, không tự thêm món được

## Query & Schema kết hợp với nhau như nào?
- **Schema (Menu)**: Được tạo sẵn, cho bạn biết có những gì để chọn
- **Query (Gọi món)**: Viết yêu cầu dựa trên Schema

# Query phức tạp hơn
- Bây giờ bạn không chỉ muốn lấy nguyên món ăn, mà bạn muốn lấy cả đầu bếp nấu món đó. 
```js
query {
  haiSan {
    tomHum {
      name
      dauBep {
        name
        age
      }
    }
  }
}
```
- `haiSan { name, dauBep {name, age} }`: Cho tôi tên Tôm hùm và thông tin đầu bếp nấu nó (tên, tuổi)
- Kết quả trả về: `Hải sản: Tôm hùm, Đầu bếp: Vũ Dz, 18 tủi`
